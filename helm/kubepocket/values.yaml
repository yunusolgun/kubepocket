# helm/kubepocket/values.yaml
# KubePocket v2.0.1 - With anomaly detection and forecasting (stable)

# Number of replicas (only 1 supported for HA mode)
replicaCount: 1

# Docker image configuration
image:
  repository: kubepocket/kubepocket
  tag: 2.0.1
  pullPolicy: IfNotPresent

# Image pull secrets (if using private registry)
imagePullSecrets: []

# Name override
nameOverride: ""
fullnameOverride: ""

# Service account configuration
serviceAccount:
  create: true
  name: ""

# Collector settings
collector:
  # Collection interval in seconds
  interval: 300
  # Log level: INFO, DEBUG, WARNING, ERROR
  logLevel: INFO
  # Statistics calculation interval (seconds)
  statsInterval: 3600

# Anomaly detection settings
anomaly:
  enabled: true
  # Z-score threshold (higher = less sensitive)
  zScoreThreshold: 3.0
  # Minimum data points required
  minDataPoints: 10

# Forecasting settings
forecast:
  enabled: true
  # Forecast horizon in days
  horizonDays: 7
  # Minimum confidence threshold (0-1)
  minConfidence: 0.5

# Persistent storage for SQLite database
persistence:
  enabled: true
  size: 5Gi # Increased for historical data
  storageClass: ""
  accessMode: ReadWriteOnce

# Service configuration
service:
  apiPort: 8000
  metricsPort: 8001
  type: ClusterIP

# Resource limits and requests
resources:
  requests:
    memory: 512Mi # Increased for ML calculations
    cpu: 200m
  limits:
    memory: 1Gi
    cpu: 500m

# Node selector
nodeSelector: {}

# Tolerations
tolerations: []

# Affinity
affinity: {}

# Pod security context
podSecurityContext: {}
  # fsGroup: 2000

# Container security context
securityContext: {}
  # capabilities:
  #   drop:
  #   - ALL
  # readOnlyRootFilesystem: true
  # runAsNonRoot: true
  # runAsUser: 1000

# RBAC configuration
rbac:
  create: true
  # Additional rules for custom resources
  extraRules: []

# Prometheus ServiceMonitor (for Prometheus Operator)
serviceMonitor:
  enabled: true
  interval: 30s
  scrapeTimeout: 10s
  # Additional labels
  labels: {}
  # Metric relabeling
  metricRelabelings: []
  # Target labels
  targetLabels: []
  # Pod labels
  podTargetLabels: []

# Grafana dashboard
grafana:
  dashboard:
    enabled: true
    # ConfigMap name for dashboard
    configMapName: kubepocket-grafana-dashboard
    # Dashboard folder in Grafana
    folder: "Kubernetes"
    # Dashboard ID (if using Grafana.com)
    dashboardId: 12345

# Alert rules for Prometheus
alertRules:
  enabled: true
  # Additional alert rules
  extraRules: []

# PodDisruptionBudget
podDisruptionBudget:
  enabled: false
  minAvailable: 1
  # maxUnavailable: 1

# HorizontalPodAutoscaler
autoscaling:
  enabled: false
  minReplicas: 1
  maxReplicas: 3
  targetCPUUtilizationPercentage: 80
  targetMemoryUtilizationPercentage: 80

# NetworkPolicy
networkPolicy:
  enabled: false
  # Ingress rules
  ingress: []
  # Egress rules
  egress: []

# Pod annotations
podAnnotations: {}

# Pod labels
podLabels: {}

# Priority class name
priorityClassName: ""

# Termination grace period
terminationGracePeriodSeconds: 30

# Environment variables
extraEnv: []
# - name: EXTRA_VAR
#   value: "value"

# Extra volumes
extraVolumes: []

# Extra volume mounts
extraVolumeMounts: []

# Namespace configuration
namespace:
  create: false # We use --create-namespace flag

# values.yaml'ınızın sonuna EKLEYİN:

# ⚠️ YENİ: Persistence ayarları
persistence:
  enabled: true
  size: 1Gi
  storageClass: ""  # Kubernetes default storage class kullanılır

# ⚠️ YENİ: RBAC
rbac:
  create: true

# ⚠️ YENİ: Hangi namespace'i izlesin? (boş bırakılırsa tüm namespace'ler)
watchNamespace: ""

# ⚠️ YENİ: Konfigürasyon (settings.yaml içeriği)
config:
  anomaly_detection:
    window_size: 100
    cpu_threshold: 2.0
    memory_threshold: 2.0
  
  monitoring:
    check_interval: 30
    namespace: "default"
  
  alerts:
    slack:
      enabled: false
      webhook: ""
    email:
      enabled: false
      smtp_server: "smtp.gmail.com"
      smtp_port: 587

# ⚠️ YENİ: Log seviyesi
logLevel: INFO